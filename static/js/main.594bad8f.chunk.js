(this.webpackJsonplab2=this.webpackJsonplab2||[]).push([[0],{13:function(e,t,a){e.exports=a(25)},18:function(e,t,a){},20:function(e,t,a){},21:function(e,t,a){},24:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(10),i=a.n(s),c=(a(18),a(1)),o=a.n(c),l=a(2),m=a(3),u=a(5),d=a(4),p=a(6),v=(a(20),a(7)),C=(a(21),"689a901bd72a2a9653fbcdaea1ffafd5"),f=function(e){return h(fetch("https://api.openweathermap.org/data/2.5/weather?q="+e+"&appid="+C+"&lang=ru",{mode:"cors",method:"GET"}))},h=function(e){return e.then((function(e){return e}),(function(e){console.log(e)})).then(function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json().then((function(e){return e}));case 2:if(a=e.sent,!t.ok){e.next=7;break}return e.abrupt("return",{status:"ok",response:a});case 7:return e.abrupt("return",{status:"fail",response:a});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},E=function(e){return[{key:"\u0412\u0435\u0442\u0435\u0440",value:e.wind.speed+" m/s"+(e.wind.deg?", "+e.wind.deg+"\xb0":"")},{key:"\u041e\u0431\u043b\u0430\u0447\u043d\u043e\u0441\u0442\u044c",value:e.weather[0].description},{key:"\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435",value:e.main.pressure+" hPa"},{key:"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c",value:e.main.humidity+" %"},{key:"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b",value:e.coord.lat+", "+e.coord.lon}]},N=a(11),y=JSON.parse(localStorage.state||"[]"),b=Object(N.a)((function(e,t){switch(t.type){case"addCity":return e.concat([t.data]);case"deleteCity":return e.filter((function(e){return e!==t.data}));default:return e}}),y);b.subscribe((function(){var e;e=b.getState(),localStorage.state=JSON.stringify(e)}));var g=b,k=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).render=function(){return n.a.createElement("div",{className:"FavoriteCity"},n.a.createElement("div",{className:"FC-container"},n.a.createElement("div",{className:"FC-header"},n.a.createElement("div",{className:"FC-name"},a.state.city),a.state.data?n.a.createElement("div",{className:"FC-temperature"},n.a.createElement("span",{className:"FC-temp-data"},(a.state.data.main.temp-273.14).toFixed(1)),n.a.createElement("span",{className:"FC-temp-units"},"\xb0C")):"",a.state.data?n.a.createElement("img",{className:"FC-weather-icon",src:"http://openweathermap.org/img/wn/"+a.state.data.weather[0].icon+".png",alt:""}):"",n.a.createElement("button",{className:"FC-remove-btn",onClick:function(e){e.preventDefault(),g.dispatch({type:"deleteCity",data:a.props.city})}},"X")),a.state.data?n.a.createElement("div",{className:"FC-data-lines"},a.state.parsed.map((function(e){return n.a.createElement("div",{key:e.key,className:"FC-data-line"},n.a.createElement("div",{className:"FC-data-line-key"},e.key),n.a.createElement("div",{className:"FC-data-line-value"},e.value))}))):n.a.createElement("div",{className:"FC-loader"},n.a.createElement("div",{className:"FC-loader-container"},n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"}),n.a.createElement("div",{className:"FC-loader-element"})))))},a.state={city:e.city,data:null},a}return Object(p.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(this.props.city);case 2:t=e.sent,a=t.response,r=E(a),this.setState({data:a,parsed:r,city:a.name+", "+a.sys.country});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(n.a.Component),w=(a(24),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).render=function(){return n.a.createElement("div",{className:"CurrentCity"},a.state.data&&n.a.createElement("div",{className:"CC-left"},n.a.createElement("div",{className:"CC-name"},a.state.city),n.a.createElement("div",{className:"CC-main-block"},n.a.createElement("img",{className:"CC-weather-icon",src:"http://openweathermap.org/img/wn/"+a.state.data.weather[0].icon+"@2x.png",alt:""}),n.a.createElement("div",{className:"CC-temperature"},n.a.createElement("span",{className:"CC-temp-data"},(a.state.data.main.temp-273.14).toFixed(1)),n.a.createElement("span",{className:"CC-temp-units"},"\xb0C")))),a.state.parsed?n.a.createElement("div",{className:"CC-right"},n.a.createElement("div",{className:"CC-data-lines"},a.state.parsed.map((function(e){return n.a.createElement("div",{key:e.key,className:"CC-data-line"},n.a.createElement("div",{className:"CC-data-line-key"},e.key),n.a.createElement("div",{className:"CC-data-line-value"},e.value))})))):"",a.state.data?"":n.a.createElement("div",{className:"CC-loader"},n.a.createElement("div",{className:"CC-loader-container"},n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}),n.a.createElement("div",{className:"CC-loader-element"}))))},a.state={currentPosition:e.currentPosition},a}return Object(p.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n=this.state.currentPosition.coords,h(fetch("https://api.openweathermap.org/data/2.5/weather?lat="+n.latitude+"&lon="+n.longitude+"&appid="+C+"&lang=ru",{mode:"cors",method:"GET"}));case 2:t=e.sent,a=t.response,r=E(a),this.setState({data:a,parsed:r,city:a.name+", "+a.sys.country});case 6:case"end":return e.stop()}var n}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(n.a.Component)),x=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).updateGeo=function(e){return navigator.geolocation.getCurrentPosition((function(e){a.setState({currentPosition:e})}),(function(e){a.setState({error:{text:"\u0413\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430",reason:"geo"}}),console.log("GeoAPI is not permitted")}))},a.componentDidMount=function(){return a.updateGeo()},a.addCityToFavorite=function(){var e=Object(l.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=5;break}return a.setState({error:{text:"\u0417\u0430\u0434\u0430\u043d \u043f\u0443\u0441\u0442\u043e\u0439 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441",reason:"input"}}),a.errorTimeout&&clearTimeout(a.errorTimeout),a.errorTimeout=setTimeout((function(){a.setState({error:void 0}),a.errorTimeout=null}),5e3),e.abrupt("return",!1);case 5:return e.next=7,f(t);case 7:if("ok"!==(r=e.sent).status){e.next=19;break}if(-1!==a.state.favoriteCities.indexOf(r.response.name)){e.next=14;break}return g.dispatch({type:"addCity",data:r.response.name}),e.abrupt("return",!0);case 14:a.setState({error:{text:"\u0413\u043e\u0440\u043e\u0434 "+r.response.name+" \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u0432 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u044b\u0445",reason:"input"}}),a.errorTimeout&&clearTimeout(a.errorTimeout),a.errorTimeout=setTimeout((function(){a.setState({error:void 0}),a.errorTimeout=null}),5e3);case 17:e.next=22;break;case 19:a.setState({error:{text:"404"===r.response.cod?"\u0413\u043e\u0440\u043e\u0434 "+t+" \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d":"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 API",reason:"api"}}),a.errorTimeout&&clearTimeout(a.errorTimeout),a.errorTimeout=setTimeout((function(){a.setState({error:void 0}),a.errorTimeout=null}),5e3);case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.render=function(){return n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"A-geo"},n.a.createElement("div",{className:"A-geo-text"},"\u041f\u043e\u0433\u043e\u0434\u0430 \u0437\u0434\u0435\u0441\u044c"),void 0===a.state.error||"geo"!==a.state.error.reason?n.a.createElement("button",{className:"A-geo-update-btn",onClick:a.updateGeo},"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0433\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044e"):""),a.state.error&&n.a.createElement("div",{className:"A-error-msg"},a.state.error.text),a.state.currentPosition&&n.a.createElement(w,{currentPosition:a.state.currentPosition}),n.a.createElement("div",{className:"A-favorite"},n.a.createElement("div",{className:"A-favorite-header"},n.a.createElement("div",{className:"A-favorite-header-text"},"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"),n.a.createElement("form",{className:"A-favorite-header-add",onSubmit:function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a.addCityToFavorite(a.inputCity.current.value);case 3:if(!e.sent){e.next=5;break}a.inputCity.current.value="";case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},n.a.createElement("input",{ref:a.inputCity,className:"A-favorite-header-add-input",type:"text",placeholder:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0433\u043e\u0440\u043e\u0434"}),n.a.createElement("input",{type:"submit",className:"A-favorite-header-add-btn",value:"+"}))),n.a.createElement("div",{className:"A-favorite-list"},a.state.favoriteCities&&a.state.favoriteCities.map((function(e){return n.a.createElement(k,{key:e,city:e})})))))},a.state={currentPosition:null,favoriteCities:null},a.inputCity=n.a.createRef(),a.state.favoriteCities=g.getState(),g.subscribe((function(){a.setState({favoriteCities:g.getState()})})),a}return Object(p.a)(t,e),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[13,1,2]]]);
//# sourceMappingURL=main.594bad8f.chunk.js.map